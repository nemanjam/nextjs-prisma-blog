# Migration `20200621185649-init`

This migration has been generated by nemanjam at 6/21/2020, 6:56:49 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."User" (
"bio" TEXT   ,"email" TEXT NOT NULL  ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"image" TEXT   ,"password" TEXT   ,"role" TEXT NOT NULL DEFAULT 'USER' ,"username" TEXT   )

CREATE TABLE "quaint"."Article" (
"authorId" INTEGER NOT NULL  ,"body" TEXT NOT NULL  ,"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"description" TEXT NOT NULL  ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"slug" TEXT NOT NULL  ,"title" TEXT NOT NULL  ,"updatedAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."Comment" (
"articleId" INTEGER NOT NULL  ,"authorId" INTEGER NOT NULL  ,"body" TEXT NOT NULL  ,"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"updatedAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,FOREIGN KEY ("articleId") REFERENCES "Article"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("authorId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."Category" (
"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"name" TEXT NOT NULL  )

CREATE TABLE "quaint"."_UserFavorites" (
"A" INTEGER NOT NULL  ,"B" INTEGER NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Article"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("B") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."_UserFollows" (
"A" INTEGER NOT NULL  ,"B" INTEGER NOT NULL  ,FOREIGN KEY ("A") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("B") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE TABLE "quaint"."_ArticlesCategories" (
"A" INTEGER NOT NULL  ,"B" INTEGER NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Article"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("B") REFERENCES "Category"("id") ON DELETE CASCADE ON UPDATE CASCADE)

CREATE UNIQUE INDEX "quaint"."User.email" ON "User"("email")

CREATE UNIQUE INDEX "quaint"."User.username" ON "User"("username")

CREATE UNIQUE INDEX "quaint"."Article.slug" ON "Article"("slug")

CREATE UNIQUE INDEX "quaint"."Category.name" ON "Category"("name")

CREATE UNIQUE INDEX "quaint"."_UserFavorites_AB_unique" ON "_UserFavorites"("A","B")

CREATE  INDEX "quaint"."_UserFavorites_B_index" ON "_UserFavorites"("B")

CREATE UNIQUE INDEX "quaint"."_UserFollows_AB_unique" ON "_UserFollows"("A","B")

CREATE  INDEX "quaint"."_UserFollows_B_index" ON "_UserFollows"("B")

CREATE UNIQUE INDEX "quaint"."_ArticlesCategories_AB_unique" ON "_ArticlesCategories"("A","B")

CREATE  INDEX "quaint"."_ArticlesCategories_B_index" ON "_ArticlesCategories"("B")

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200621185649-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,55 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "sqlite"
+  url      = "file:./dev.db"
+}
+
+model User {
+  bio        String?
+  email      String    @unique
+  id         Int       @default(autoincrement()) @id
+  image      String?
+  password   String?
+  username   String?   @unique
+  role       String    @default("USER")
+  articles   Article[] @relation("UserArticles")
+  favorites  Article[] @relation("UserFavorites", references: [id])
+  followedBy User[]    @relation("UserFollows", references: [id])
+  following  User[]    @relation("UserFollows", references: [id])
+  comments   Comment[]
+}
+
+model Article {
+  id          Int        @default(autoincrement()) @id
+  slug        String     @unique
+  title       String
+  description String
+  body        String
+  createdAt   DateTime   @default(now())
+  updatedAt   DateTime   @default(now())
+  author      User       @relation("UserArticles", fields: [authorId], references: [id])
+  authorId    Int
+  favoritedBy User[]     @relation("UserFavorites", references: [id])
+  comments    Comment[]
+  categories  Category[] @relation("ArticlesCategories", references: [id])
+}
+
+model Comment {
+  id        Int      @default(autoincrement()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now())
+  body      String
+  article   Article  @relation(fields: [articleId], references: [id])
+  articleId Int
+  author    User     @relation(fields: [authorId], references: [id])
+  authorId  Int
+}
+
+model Category {
+  id    Int       @default(autoincrement()) @id
+  name  String    @unique
+  posts Article[] @relation("ArticlesCategories", references: [id])
+}
```


